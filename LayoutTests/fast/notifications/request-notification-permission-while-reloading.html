<!DOCTYPE html>
<body>
<p>This tests that notification permission requests during page reload do not cause a crash.</p>
<p id="message">FAIL: Test did not run to completion yet.</p>
<script>

if (window.testRunner) {
    testRunner.dumpAsText();
    testRunner.waitUntilDone();
}

var tries = location.hash.substring(1) >>> 0;
if (tries < 10) {
    location.hash = "#" + (tries + 1);
    location.reload();

    setTimeout(function() {
        webkitNotifications.requestPermission();
    }, 0);
} else {
    document.getElementById("message").textContent = "PASS: Test passed if we saw no crash.";
    if (window.testRunner)
        testRunner.notifyDone();
}

</script>
</body>
